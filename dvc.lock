schema: '2.0'
stages:
  expand:
    cmd: bash expand_data.sh
    deps:
    - path: docs_dump.zip
      hash: md5
      md5: 2dfe0f1dbd30ef26e75cbaa56e6e9fec
      size: 470834
    - path: expand_data.sh
      hash: md5
      md5: 6aca8ab03e2fa106e81b21d04ba2adb7
      size: 229
    outs:
    - path: data
      hash: md5
      md5: d3406c3230f9614c651b531a33a6a869.dir
      size: 20724476
      nfiles: 262
  ingest:
    cmd: python ingest.py
    deps:
    - path: data
      hash: md5
      md5: d3406c3230f9614c651b531a33a6a869.dir
      size: 20724476
      nfiles: 262
    - path: ingest.py
      hash: md5
      md5: 0c4486eec273a8434776931027a4c8db
      size: 1396
    params:
      params.yaml:
        TextSplitter:
          chunk_size: 1500
          chunk_overlap: 200
          keep_separator: false
          add_start_index: false
    outs:
    - path: docs.json
      hash: md5
      md5: fde59b090e0373aaafe406ddabea697a
      size: 1229954
    - path: metadatas.json
      hash: md5
      md5: 53c7a3a2fa01225103e07c03b47ef9e1
      size: 69964
  vectorize:
    cmd: python vector_store.py
    deps:
    - path: docs.json
      hash: md5
      md5: fde59b090e0373aaafe406ddabea697a
      size: 1229954
    - path: metadatas.json
      hash: md5
      md5: 53c7a3a2fa01225103e07c03b47ef9e1
      size: 69964
    - path: vector_store.py
      hash: md5
      md5: 73490e86c79b867dfaa2e1eb490d90e6
      size: 574
    params:
      params.yaml:
        Embeddings:
          num_ctx: 8191
          model: llama2:7b
          show_progress: true
    outs:
    - path: docs.index
      hash: md5
      md5: 3ed8a4f536b66ead3c6272548e47aba6.dir
      size: 15793100
      nfiles: 2
  run:
    cmd: python qa.py
    deps:
    - path: canfy.csv
      hash: md5
      md5: f4d4c1221515fe413e7cdf383c1ab2db
      size: 6467
    - path: docs.index
      hash: md5
      md5: 3ed8a4f536b66ead3c6272548e47aba6.dir
      size: 15793100
      nfiles: 2
    - path: qa.py
      hash: md5
      md5: 7cb0350272762980e5a6a28eb64a7fef
      size: 1514
    params:
      params.yaml:
        Chat:
          model: llama2:7b
        Embeddings:
          num_ctx: 8191
          model: llama2:7b
          show_progress: true
        Retrieval:
          max_tokens_limit: 3375
          reduce_k_below_max_tokens: false
          verbose: true
    outs:
    - path: results.csv
      hash: md5
      md5: e3f1c3316fc64c52deeed9f4f926aaa0
      size: 9493
  setup:
    cmd: bash setup.sh
    deps:
    - path: requirements.txt
      hash: md5
      md5: 632aca6f221712966f94dd2b46af4827
      size: 2847
    - path: setup.sh
      hash: md5
      md5: e99c2ce134bc2775626551e823a8b8ef
      size: 251
  eval:
    cmd: python eval.py
    deps:
    - path: canfy.csv
      hash: md5
      md5: f4d4c1221515fe413e7cdf383c1ab2db
      size: 6467
    - path: eval.py
      hash: md5
      md5: 54f4bf667cde7c43cc12d1a574f937e6
      size: 1255
    - path: results.csv
      hash: md5
      md5: e3f1c3316fc64c52deeed9f4f926aaa0
      size: 9493
    params:
      params.yaml:
        Eval:
          model: llama2:7b
    outs:
    - path: eval.csv
      hash: md5
      md5: 1ad2ebde4ae50e12cef8a406c74fe210
      size: 6671
