schema: '2.0'
stages:
  setup:
    cmd: bash setup.sh
    deps:
    - path: requirements.txt
      hash: md5
      md5: b932dcdba32807afaa351e7f5c434923
      size: 2985
    - path: setup.sh
      hash: md5
      md5: 1881cad25780801542082d6721a35d2f
      size: 374
  expand:
    cmd: bash expand_data.sh
    deps:
    - path: docs_dump.zip
      hash: md5
      md5: 2dfe0f1dbd30ef26e75cbaa56e6e9fec
      size: 470834
    - path: expand_data.sh
      hash: md5
      md5: 6aca8ab03e2fa106e81b21d04ba2adb7
      size: 229
    outs:
    - path: data
      hash: md5
      md5: d3406c3230f9614c651b531a33a6a869.dir
      size: 20724476
      nfiles: 262
  ingest:
    cmd: python ingest.py
    deps:
    - path: data
      hash: md5
      md5: d3406c3230f9614c651b531a33a6a869.dir
      size: 20724476
      nfiles: 262
    - path: ingest.py
      hash: md5
      md5: 3fd9313fa6328a66edd5df50365d5c89
      size: 658
    params:
      params.yaml:
        TextSplitter:
          chunk_size: 1500
          chunk_overlap: 200
          keep_separator: false
          add_start_index: false
    outs:
    - path: docs.json
      hash: md5
      md5: 996927057b3a62f62f91026de328737f
      size: 806223
    - path: metadatas.json
      hash: md5
      md5: 0c50c613202d5bfedfcfccfe52abfc4e
      size: 10985
  vectorize:
    cmd: python vector_store.py
    deps:
    - path: docs.json
      hash: md5
      md5: 996927057b3a62f62f91026de328737f
      size: 806223
    - path: metadatas.json
      hash: md5
      md5: 0c50c613202d5bfedfcfccfe52abfc4e
      size: 10985
    - path: vector_store.py
      hash: md5
      md5: 1cc3f7e460d667600c2ad56bde5d54d3
      size: 594
    params:
      params.yaml:
        Embeddings:
          model_name: sentence-transformers/all-mpnet-base-v2
          model_kwargs:
            device: cpu
          encode_kwargs:
            normalize_embeddings: true
            show_progress_bar: true
    outs:
    - path: docs.index
      hash: md5
      md5: a5a19ab5099217be7a2887412c7342b3.dir
      size: 2193521
      nfiles: 2
  run:
    cmd: python qa.py
    deps:
    - path: docs.index
      hash: md5
      md5: a5a19ab5099217be7a2887412c7342b3.dir
      size: 2193521
      nfiles: 2
    - path: ground_truths.csv
      hash: md5
      md5: a26c282ef7fedbe00ac47917c88dbc19
      size: 1087
    - path: qa.py
      hash: md5
      md5: 2ab451c19db87400397259450fb06297
      size: 1548
    params:
      params.yaml:
        ChatLLM:
          repo_id: HuggingFaceH4/zephyr-7b-beta
        Embeddings:
          model_name: sentence-transformers/all-mpnet-base-v2
          model_kwargs:
            device: cpu
          encode_kwargs:
            normalize_embeddings: true
            show_progress_bar: true
        Retrieval:
          max_tokens_limit: 3375
          reduce_k_below_max_tokens: false
          verbose: true
    outs:
    - path: results.json
      hash: md5
      md5: 630020d9e3b7b41d5712cb7f48233e5c
      size: 21864
  eval:
    cmd: python eval.py
    deps:
    - path: eval.py
      hash: md5
      md5: 9bdd109eae3eaabb73564eff4497fe8e
      size: 1281
    - path: ground_truths.csv
      hash: md5
      md5: a26c282ef7fedbe00ac47917c88dbc19
      size: 1087
    - path: results.json
      hash: md5
      md5: 630020d9e3b7b41d5712cb7f48233e5c
      size: 21864
    outs:
    - path: eval.csv
      hash: md5
      md5: fe8c3c2540a46e6481ce0b9a3e9a89d3
      size: 1419
  eval-ragas:
    cmd: python eval_ragas.py
    deps:
    - path: canfy.csv
      hash: md5
      md5: f4d4c1221515fe413e7cdf383c1ab2db
      size: 6467
    - path: eval_ragas.py
      hash: md5
      md5: 7395c48d77477b43bb9b525f857a24d1
      size: 1014
    - path: results.csv
      hash: md5
      md5: c80cc3cc6f224b94f4571f1da2721353
      size: 5851
    outs:
    - path: eval_ragas.csv
      hash: md5
      md5: 0e5e02f44e3a50c48942a71452d22296
      size: 11105
  eval_ragas:
    cmd: python eval_ragas.py
    deps:
    - path: eval_ragas.py
      hash: md5
      md5: eb8a71c10e09837b821ccbd6b3bc5087
      size: 1046
    - path: ground_truths.csv
      hash: md5
      md5: a26c282ef7fedbe00ac47917c88dbc19
      size: 1087
    - path: results.json
      hash: md5
      md5: 630020d9e3b7b41d5712cb7f48233e5c
      size: 21864
    outs:
    - path: eval_ragas.csv
      hash: md5
      md5: ea1520b839bb2b57ad915efc25d2b578
      size: 22606
